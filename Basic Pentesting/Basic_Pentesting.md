# Basic Pentesting

--- 

## Task 1: Web App Testing and Privilege Escalation

1. Find the services exposed by the machine

Để tìm được các dịch vụ của máy, mình sẽ sử dụng `nmap` để xử lý.
Command mình sử dụng: `sudo nmap -sV $ip` . Trong đó 
- `-sV` chính là thông báo những cổng nào đang mở và những dịch vụ, phiên bản của những cổng đó.

![](https://github.com/vinhxinh/tryhackme/blob/main/Basic%20Pentesting/pic1.png?raw=true)

2. What is the name of the hidden directory on the web server(enter name without /)?: `development`.

Để tìm được các đường dẫn ẩn mình sẽ sử dụng `gobuster` để brute force các đường dẫn cơ bản. Command mình sử dụng: `gobuster -w $dỉr_to_wordlist dir -u http://$ip`. Trong đó mình cần lưu ý thêm dir trước tham số -u để nhận biết file đường dẫn đến trang web.

![](https://github.com/vinhxinh/tryhackme/blob/main/Basic%20Pentesting/pic2.png?raw=true)

3. User brute-forcing to find the username & password

Mình sẽ sử dụng `enum4linux` để tìm liệt kê các cách tấn công được vào server. Ở đây bỏ qua các thông tin không liên quan mình đã có được thông tin của 2 user trong hệ thống là `Jan` và `Kay`. Command mình sử dụng ở đây là: `enum4linux $ip`.

![](https://github.com/vinhxinh/tryhackme/blob/main/Basic%20Pentesting/pic3.png?raw=true)

Trước đó khi truy cập vào đường dẫn ẩn `/development` mình đã có tên viết tắt của 2 user trên. Tuy nhiên đoạn hội thoại của 2 nhân vật, `Kay` có nhắc `Jan` cần phải đổi mật khẩu vì `Kay` có thể xâm nhập vào hệ thống nhờ một lỗi bảo mật.

Vậy từ những thông tin trên, mình nghĩ nên brute force mật khẩu của `Jan` là hợp lý. Command mình sử dụng: `hydra -l jan -P $dir_to_rockyou.txt ssh://$ip`.

![](https://github.com/vinhxinh/tryhackme/blob/main/Basic%20Pentesting/pic4.png?raw=true)

4. What is the username?: `jan`.
5. What is the password?: `armando`.
6. What service do you use to access the server(answer in abbreviation in all caps)?: `SSH`.

7. Enumerate the machine to find any vectors for privilege escalation.

Sau khi ssh lên server bằng tài khoản của user `jan` mình đã thử tìm các lệnh được chạy dưới quyền root. Tiếc là không có lệnh nào được chạy dưới quyền root. 

Tuy nhiên từ user `Jan` mình có thể vào thư mục của `Kay`. Trong này có một file `pass.bak` chắc chắn là thứ mình cần tìm, tuy nhiên nó chỉ có quyền truy cập khi mình là user `Kay` vậy mình sẽ tìm cách log với quyền của `Kay`.

Trong file của Kay có dẫn nhiều thư mục ẩn. Trong đó hay ho nhất là `.ssh` mình nghĩ trong này sẽ chứa private key để log lên server.

Trong này có 2 file có thể sử dụng đó là `authorize_key` và `id_rsa`. Tuy nhiên file `authorize_key` có mật mã dạng base64 và mã hóa không ra gì cả nên không dùng được. Mình chỉ còn cách xử lý đống key rsa bằng `john` để lấy mật khẩu cụ thể ssh lên server của `Kay`. Trước đó mình cần chuyển đống mã hóa `sha256` sang dạng john có thể hiểu được bằng `ssh2john`.

Command mình sẽ sử dụng: 

- `ssh2john id_rsakay > sshhash`
- `sudo john --wordlist=$dir_to_rockyou.txt sshhash`

![](https://github.com/vinhxinh/tryhackme/blob/main/Basic%20Pentesting/pic5.png?raw=true)

Mật khẩu sẽ là: `beeswax`. Lưu ý khi ssh đến server mà có private key thì ta cần phải set quyền của file id_rsa về chỉ có user gốc mới có quyền đọc ghi, còn lại không có quyền thì ssh mới verified.
Command mình sẽ sử dụng: `chmod 600 id_rsa`.

- `ssh -i id_rsa kay@$ip`.

![](https://github.com/vinhxinh/tryhackme/blob/main/Basic%20Pentesting/pic6.png?raw=true)

8. What is the name of the other user you found(all lower case)?: `kay`.
9. What is the final password you obtain?: `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`.




